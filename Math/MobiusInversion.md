# $M\ddot{o}bius$ 反演
&emsp; 友情提醒：本文中的证明过程大多是作者~~也就是我~~自己弄出来的，不能保证过程的严谨性，看着有道理就完了 \doge。

----
&emsp; 看着这个叫莫比乌斯反演的东西，我们就知道，这玩意儿肯定是由莫比乌斯和反演两部分构成的 /doge。所以我们来分别看看两部分是啥意思。

#### 一、$M\ddot{o}bius$ 函数
&emsp; 这个函数是一个非常优秀~~让人看着难受~~的函数。它的定义式如下：
$$ \mu(n) = 
\begin{cases}
1，\qquad \qquad n = 1 \\
(-1)^k \qquad \quad 当 n = \prod_{i=1}^{k}p_i，p_i 是互不相同的质数时 \\
0，\qquad \qquad 当 n 质因数分解时分解出的质因子的每次大于一时
\end{cases}
 $$
&emsp; 你别看它看起来复杂 ~~实际上也确实很复杂~~，但是它有一些非常神奇的性质，就比如在莫比乌斯反演里面经常要用到的下面这个性质：
$$ \sum_{d \mid n}\mu(d) = [n = 1] $$

&emsp; 是不是看起来更复杂了 \doge 。下面我们考虑证明这个性质。首先这个东西肯定是要分成两种情况的：
1. 第一种 n = 1 的时候，显然有 $\sum_{d \mid n} \mu(d) = \mu(n) = \mu(1) = 1$
2. 第二种 $n \neq 1$ 的时候就有点烦人了，证明是时候要用到二项式定理（~~其实也可以不用，只是那样写起来就太麻烦了，我会在另一篇文章里面写到关于这部分的东西（链接会放在最下方）~~ ），但是我们还是来看一看。
显然我们在计算 $\sum_{d \mid n} \mu(d)$ 的时候只需要考虑那些使得 $\mu(d) \neq 0$ 的 d，所以我们假设：
$$ n = \prod_{i=1}^{k}p_i^{a_i} $$
当 $\mu(d) \neq 0$ 的时候也就是说 d 的质因子的幂次都不大于一的时候，d 可以被写成这样：
$$ d = \prod_{i=1}^{t}p_i $$
所以说我们可以得到拥有 t 个质因子且质因子幂次不大于一的因数的数量为 $C_{k}^{t}$，当 t 为奇数的时候 $\mu(d) = -1$，当 t 为偶数的时候 $\mu(d) = 1$，所以我们得到以下的式子：
$$ \sum_{d \mid n}\mu(d) = C_{k}^{0} - C_{k}^{1} + C_{k}^{2} - C_{k}^{3} + \cdots + (-1)^{k}C_k^k = \sum_{i=0}^{k}(-1)^iC_k^i $$
根据这个式子，接下来我们只需要证明 $\sum_{i=0}^{k}(-1)^iC_k^i$ 等于 0 就好了。然后我们就要用到大名鼎鼎的二项式定理了，二项式定理他长这样：
$$ (a + b)^n = \sum_{i=0}^{n}C_n^i a^{n - i}b^i $$
我们将 a = -1，b = 1 带入二项式定理，就得到了：
$$ (1 + -1)^n = \sum_{i=0}^{n}C_n^i 1^{n-i} (-1)^i = \sum_{i=0}^{n}(-1)^iC_n^i = 0 $$
然后我们就证毕啦！

----
#### 二、关于莫比乌斯反演
&emsp; 现在我们来到了重要的部分，也就是莫比乌斯反演。我们先看结论：F(n) 和 G(n) 是定义在非负整数集上的两个函数，如果两者满足：
$$ F(n) = \sum_{d \mid n}G(d) $$

&emsp; 我们就有：

$$ G(n) = \sum_{d \mid n} \mu(d)F( \frac{n}{d} ) $$

&emsp; 这个神奇的玩意儿的证明肯定也非常的神奇，所以我们就来神奇的证一下它：
$$
\begin{aligned}
&\sum_{d \mid n} \mu(d)F( \frac{n}{d} ) = \sum_{d \mid n} \mu(d) \sum_{i \mid  \frac{n}{d} }G(i)\\
=&\sum_{d \mid n}\sum_{i \mid  \frac{n}{d} }\mu(d)G(i) = \sum_{i \mid n}G(i) \sum_{d \mid \frac{n}{i} } \mu(d)
\end{aligned}
$$

&emsp; 这两步应该比较好懂，最后一步就要用到我们在上面证明过的莫比乌斯函数的性质了，也就是 $\sum_{d \mid n}\mu(d) = [n = 1]$。我们在每次计算 $\sum_{d \mid \frac{n}{i}} \mu(d)$ 的时候，只有 $\frac{n}{i} = 1$ 的时候，也就是 $n = i$ 时 才有值为 1，其他时候都是 0，也就是说后面那一大坨式子就退化成了 $[i = n]$：
$$ \sum_{i \mid n}G(i) \sum_{d \mid\frac{n}{d}} \mu(d) =  \sum_{i \mid n}G(i)[i=n] = G(n)  $$
也就是：

$$ \sum_{d \mid n} \mu(d)F(\frac{n}{d}) = G(n) $$
证毕。

&emsp; 我们也可以知道除了 $F(n) = \sum_{d \mid n}G(d)$ 这样写， F(n) 也可以写成这样：
$$ F(n) = \sum_{d \mid n}G(d) = \sum_{d \mid n}G(\frac{n}{d}) $$

&emsp; 所以莫比乌斯反演也还可以写成：
$$ G(n) = \sum_{d \mid n}\mu(d)F(\frac{n}{d}) = \sum_{d \mid n}\mu(\frac{n}{d})F(d) $$

----
&emsp;附在最后： [（莫比乌斯反演）这个人将的超级好！：https://www.cnblogs.com/chenyang920/p/4811995.html](https://www.cnblogs.com/chenyang920/p/4811995.html)。

-------

## 然后我说我的那个另一种证明在这里：

### 关于一个公式

&emsp; 就是在写关于莫比乌斯反演的东西的时候，我就想着自己证明一遍莫比乌斯函数的性质（当时还没学，在边学边写），然后我就开始了疯狂的分类讨论，大概的流程是这样的：

&emsp; 证明：

&emsp; 首先我要证明 $\sum_{d \mid n} \mu(d) = [n = 1]$ 然后我就想， $n = 1$ 的时候这个式子显然成立，然后我就讨论 $n \neq 1$ 的时候。首先我想的是这个求和的式子里面一定有两项 $\mu(d)$ 和 $\mu(\frac{n}{d})$，这两个玩意儿是两两对应的，也就是说只要有一个 $d$ 就一定能找到一个 $\frac{n}{d}$，因为 d 是 n 的约数嘛。然后我考虑一组比较特殊的对应 $\mu(1)$ 和 $\mu(n)$，首先 $\mu(1)$ 肯定是 1，所以我就把它根据 $\mu(n)$ 的值分为 3 类。
1. $\mu(n) = -1$
2. $\mu(n) = 1$
3. $\mu(n) = 0$

&emsp; 首先分析第一类，因为 $\mu(1)$ 已经和 $\mu(n)$ 配对好了就是它俩加起来为0，所以我现在只需要证明其他的不为 0 的项加起来为 0就好了。

&emsp; 怎么证呢，因为我们有一个前提， $\mu(n) = -1$ 所以如果把 n 写成一堆质数的积的形式的话就是这样：
$$ n = \prod_{i = 1}^{k_1}p_i $$

&emsp; 而且我们这应该知道这里的 $k_1$ 一定是一个奇数，然后我们考虑一个 n 的因数 d
，他显然也可以写成这样的形式：
$$ d = \prod_{i=1}^{k_2}p_i $$

&emsp; 根据我们上面的思路，另一个与它对应的因数 d' 就应该等于：

$$ d' = \frac{n}{d} = \frac{\prod_{i=1}^{k_1}p_i}{\prod_{i=1}^{k_2}{p_i}} = \prod_{i=1}^{k_1-k_2}p_i $$

&emsp; 现在就应该看看 $\mu(d) + \mu(d')$ 是不是恒等于 0 了，如果是的话，我们就证毕了。而现在 $\mu(d)$ 和 $\mu(d')$ 的值肯定不是 0，所以值只和 $k_1，k_2$ 的奇偶性相关。我们根据这一点就可以继续分类讨论。我们知道 $k_1$ 一定是奇数，所以我们只用讨论 $k_2$
1. $k_2$ 是奇数，所以 $k_1 - k_2$ 就是奇数减奇数一定是偶数，所以我们得到 $\mu(d) = -1$，$\mu(d') = 1$。此时 $\mu(d) + \mu(d') = 0$
2. $k_2$ 是偶数，所以 $k_1 - k_2$ 就是奇数减偶数一定是奇数，所以我们得到 $\mu(d) = 1$，$\mu(d') = -1$。此时 $\mu(d) + \mu(d') = 0$

&emsp; 所以我们就得到了当 $\mu(n) = -1$ 时 $\sum_{d \mid n} \mu(d) = [n = 1]$。

&emsp; 然后我想着第一种已经整出来了，第二种应该也比较好证，所以我又开始讨论第二种情况，也就是 $\mu(n) = 1$ 的情况。与前面第一种情况同理，我们可以得到 $\mu(1) + \mu(n) = 2$，也就是要证明剩下的加起来为 -2。-2 这个数看起来不好凑啊，但是不慌，我们先继续往下写。

&emsp; 和前面一样，我们得到了 $k_1$ 一定是偶数，所以我们讨论 $k_2$ 的奇偶性。第一种 $k_2$ 为奇数，然后就是偶数减奇数也是奇数，那么 $\mu(d) + \mu(d') = -2$。第二种， $k_2$ 是偶数，然后就是偶数减偶数也一定是偶数，那么 $\mu(d) + \mu(d') = 2$。这看起来也就好办了，我们只需要证明 $k_2$ 是偶数的情况一定比 $k_2$ 是奇数的情况少一个就凑出了一个 -2。这显然要用到组合数学的知识，但是我的组合数学掌握的不好，所以我直接就上网搜，然后看到了这篇文章：[一个集合选奇数个和偶数个情况研究](https://blog.csdn.net/qq_36797743/article/details/76974591)。在这里我花一点地方介绍一下这篇文章里的东西。

&emsp; 这篇文章里要证明一个式子 ：
$$ \sum_{i\;mod \; 2=1}C_n^i - \sum_{j\;mod\; 2 = 0}C_n^j = [n=0] $$

&emsp; 而他这里的 j 是可以取 0 的，我上面要证明取偶数比取奇数少 1 是不能取 0 的，所以只要把它的这个式子整出来了，我上面的那个命题也就自然成立了。所以我很兴奋的点进去看了看，前半部分我是看懂了，而且他证明这个式子的思路和我证明莫比乌斯函数性质的思路出奇的一致（仅指前半部分，感兴趣的可以去看看），然而我看到后半部分用二项式定理证明这个式子的时候，我就想既然前面的思路和我的思路那么像，而且这个能用二项式定理证明，那莫比乌斯函数性质是不是也能用二项式定理证明呢？

&emsp; 然后我就模仿他的思路证了一下，然后发现真的可以，而且用二项式定理来证明比我的那个方法要简洁太多了，所以我就在[莫比乌斯反演](https://blog.csdn.net/ID246783/article/details/120826541)那篇文章里面写了用二项式定理的证明方法。

&emsp; 上面那个式子的证明（也就是第二种情况的证明）感兴趣的可以去看看那篇文章，我就不在这里写了。剩下的地方我就把最后一种情况 $\mu(n) = 0$的证明过程写完。

&emsp; $\mu(1) + \mu(n) = 1$，所以我们要证明剩下的所有 $\mu(d)$ 加起来等于 -1，但是这次我们不能保证所有的 $\mu(d)$ 都不为 0，但是我们只学要讨论那些不为 0 的情况。我们就可以把这些因数 d 分为三类。
1. $\mu(d) = 0$ 这一类我们可以不用管，因为他不影响最后的值。                                                                                                                                                                                                                                                                                                                                                                                                                                            
2. $\mu(d) \neq 0$ 且 $\mu(d') = \mu(\frac{n}{d}) \neq 0$ 的（这一类 d 只在 n 的所有质因子的幂次都不大于 2 的时候存在）。也就是说这一类中的这两个因数都可以写成这种形式：
$$ d = \prod_{i=1}^{k_2}p_i \qquad d' = \prod_{i=1}^{k_3}p_i $$
显然在 $d \neq d'$ 的时候 $k_2 和 k_3$ 的奇偶性是相反的，所以 $\mu(d) + \mu(d') = 0$。
3. $\mu(d) = \neq 0$ 且 $\mu(d') = \mu(\frac{n}{d}) = 0$。在这里类里面我们就不用管 d' ，只用关心 d 就好了。跟前面一样，d 可以写成 $d = \prod_{i=1}^{k_2}p_i$，当 $k_2$ 是奇数时 $\mu(d) = -1$，$k_2$ 是偶数时，$\mu(d) = 1$。又因为第二种情况和第一种情况的 d 加起来都是 0，所以我们需要 $k_2$ 是奇数的情况比 $k_2$ 是偶数的情况多 1，就能凑出一个 -1。那么这个问题其实也就是我们在证明 $\mu(n) = 1$ 时遇到的那个问题，所以我们知道了这总情况中 $\mu(d)$ 的和是 -1。

&emsp; 综上所述三种情况里所有 $\mu(d)$ 的和为 -1，然后再加上一个 $\mu(1)$，就是 0 了。

&emsp; 再综上所述，在三种大的情况中，我们都证明了 $\sum_{d \mid n}\mu(d) = [n  = 1]$。所以这个结论成立。
&emsp; 证毕！
